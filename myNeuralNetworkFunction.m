function [Y,Xf,Af] = myNeuralNetworkFunction(X,~,~)
%MYNEURALNETWORKFUNCTION neural network simulation function.
%
% Generated by Neural Network Toolbox function genFunction, 12-Mar-2017 19:49:28.
% 
% [Y] = myNeuralNetworkFunction(X,~,~) takes these arguments:
% 
%   X = 1xTS cell, 1 inputs over TS timesteps
%   Each X{1,ts} = 8xQ matrix, input #1 at timestep ts.
% 
% and returns:
%   Y = 1xTS cell of 1 outputs over TS timesteps.
%   Each Y{1,ts} = 4xQ matrix, output #1 at timestep ts.
% 
% where Q is number of samples (or series) and TS is the number of timesteps.

%#ok<*RPMT0>

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1.xoffset = [-100;-100;-100;-100;0;1;1;1];
x1_step1.gain = [0.01;0.01;0.01;0.01;0.0869565217391304;1;1;1];
x1_step1.ymin = -1;

% Layer 1
b1 = [-2.0501431441843412;-0.91253547864362483;1.6240749443155373;-4.4510361882611349;-2.0934818549705549;1.0021247198868477;1.6288474162395017;-2.6313526724465075;-2.0375109860144507;-0.24643128921237309;1.7202976092070241;-3.3583308095427169;-0.15516092485317198;2.5422749706924197;-1.3649295022315822;2.557755258556702;1.8319954290032576;-2.2229579097702703;-2.5870369505844026;-1.0987638566853619;-1.4161164976877256;1.7808195336565107;0.1885818419978246;-1.3063860090816162;0.0090193345193229964;-0.86672463822194912;-2.447496607463937;0.21718870076753177;-2.2487479879754182;-0.034458590534588995;0.12284649592660214;-0.76917274453375795;-0.96041025506999966;-1.5679097070354802;-0.18921549678098218;-0.15909153334417633;-0.13319500636208742;0.15799177705370676;-0.055104408986793266;0.091563727754334787;-0.0045988156530373516;-0.89843757061350693;1.4388318987442383;2.5729508428642576;-1.150139581136119;-2.4971785434067173;-1.6628079442474004;2.2572173312474817;1.2695751667439246;1.9358027032925815;-1.391772313206679;1.0017561815608766;1.5509579523104486;-0.56769290871473743;-2.6020301802084789;-1.7000157780055782;2.0922534005287479;-1.1787074491446141;1.5863586939468304;-2.5948272411086046;2.6446555194049952;-2.390288469943779;1.7991110323489741;3.1212757726883713];
IW1_1 = [0.85129600219799717 1.403812959926247 -1.0696777574677843 0.19446316659742949 0.35884328459223452 -1.4339702217845891 0.82894350379586512 0.54289162779399192;-0.094100017303966735 0.027615141692074002 0.013984000627850683 -0.017236226787430756 0.00049030420388514542 0.37744882169097399 0.5615488415045875 -0.41030896384155235;-0.0093557811900531057 0.036188659502569331 0.0027463792157960557 -0.017811444329238261 0.00064210892035351916 -0.033235405610294581 1.381934379583615 2.2828492766610213;0.00013547523641672254 0.0010185799419939543 0.015685969668923445 -0.051718465839765138 -0.00016754628721975977 2.3601909690659522 -1.0210318807067049 -2.4574344325877613;-0.022796452342836067 0.031282993002798735 -1.3179451405902802 -0.051487906069988931 -0.085436875951862459 -1.2298809097689534 1.1709456753077667 -1.0162336898331594;0.0015174479433835506 -0.0024518999332461535 -0.0045543566661496396 0.046886231356828185 0.00018060457070504269 0.4819075044627496 -0.97094314537687076 -0.5189608398808897;-0.49736644602896646 0.29347515221519127 -1.084840555970912 1.0325434978696801 0.86445742013177151 -0.36596762196593319 1.0223609242512737 -1.599149119749613;-0.011048220437801397 0.0061876979459506822 0.045046166826220244 0.01957978191403463 3.8003240532253229e-05 -0.085779074823952833 2.1988585382996435 1.9254881987392878;0.016588358581836507 -0.0031748441788883035 0.19617830532427022 0.042210947596354416 -0.00060034594649206231 1.2958310732690408 2.129257808574176 -0.64996555084006291;0.035704304632804794 -0.053086217793448617 -0.040767560048637595 -0.033167117219372898 -0.0025484538989323218 0.083721710172772607 -0.50449450321585265 0.62848517976766805;-1.0451924236723349 0.56442201328405739 0.056535658853210678 -0.14295391566666457 -0.01056254816505044 0.038879169821047173 0.098795837742915782 0.10291262252449554;0.013218409078713059 0.14717616337897982 -0.0086448368499907283 0.027995395113818957 0.002838497861425347 0.29238195919420629 -0.73426074105568007 -4.5706645056965645;1.1599005854100051 -0.20004985118959176 0.480425948430654 0.10228337536375631 -0.51075850986896842 -1.9245841765279432 0.48338043145316123 -0.85469136229881293;-0.022317358721702946 0.0091031127321691326 -0.094851082618528135 0.040474692465888237 -0.0015319573574628957 2.3789307672233195 0.40769918431612295 0.69084915076547015;-0.026948852686958149 0.0044839549793267881 -0.036192889070552514 0.7272164013560507 0.00060952117812310114 -0.007144530945700802 -0.94805804049568454 1.861582928820221;-0.072498667619385032 0.020123828516446309 0.0062381004829575142 -0.00083678027302909886 0.0005225702124799905 -3.2849980396254641 -1.4094207187048482 -3.2257319345361997;0.074021465015429139 -0.050438325792010449 0.062696698219954897 0.091742602034332751 -3.1011019843003432e-05 -0.26833626701115798 0.68048652272552901 -1.117488679725396;0.0085513931838947423 -0.0037116298944762593 -0.31152759541771269 -0.0043507695413694944 -6.8721357969210746e-05 0.024064074513015087 -1.6323897601745145 3.0765482753455333;0.37424474917276424 -0.039934409759343294 -0.016410198668035513 -0.0014298846726476184 8.9735406016348262e-05 0.0085093425327662422 1.7069410524219932 -3.4228522181811871;1.197685720142081 -0.21958653927286492 -1.0419229220226274 -0.090107013254522958 0.0092683104493711099 -0.013474585473346899 -0.72129084036526359 1.237149078064286;-0.017722488099821295 -0.010845900990948443 -0.10115054598081616 -0.042248154030901985 0.00010828125600778537 2.2850272371933569 0.36484291042594164 -0.56904054722380071;-0.016885586606658537 -0.089588338839220155 0.00020751430458477061 -0.0056033230407886297 9.0103366073636303e-05 2.1875817670698008 1.1150317319737888 2.4448898712139338;0.027116201535524177 -0.021266099599303687 -0.066019458237420656 0.22654373484052442 -0.00017404510350179454 -1.2533610035643916 0.12272835708141286 0.1452713867159347;0.3991033916407693 0.038474540116104024 0.0030297525311867111 -0.28005248080813527 0.00070169380688660894 -0.058434698070418345 -1.095102201071847 1.4395101305099693;-0.0016853960843686221 -0.010049356810860105 0.011405763762083885 -0.0636667179162618 -0.0002159764681474484 0.49270498707426386 -0.64833064402273333 -1.6066724849165126;0.47377609551199051 0.44069362772991871 1.5591848669869721 -1.0303610302604349 0.7791193942462501 -0.49585613014428342 -0.54032446728591732 -0.87675181044676376;0.043656622449976132 -0.40332965372783219 -0.00067127547021970609 0.0048159873700595358 0.00029900444859945675 0.01246421246870758 1.6331172334386148 -3.3043648924835218;-0.015424510040639048 -0.069496141636347333 0.008013306710497322 -0.011939942298612574 -0.00013758100171148733 1.8283457086668855 0.81390827437079039 0.032869696351160271;-0.004005587351027645 0.0027823519822045956 0.016521027007774129 -0.19892293388894536 -4.3138822442645271e-05 -0.033486065039606314 -1.7429282809913518 3.0457105715211772;-1.1311597927806483 0.58551084928243979 1.0869275897774635 0.76856141665498701 0.30603271621096034 1.0554653804099867 0.90583988081314892 0.51053148402132698;0.78670205440606855 0.44566141943039278 -0.18621922657557957 -0.29197686494625086 0.40282373935682364 -0.89620985429535893 1.4351785608249696 -0.099859073558018721;-0.0036888829630549519 -0.0016667071424181258 0.0048977933431133044 -0.072371373282803519 4.8268706236463868e-05 -0.28381025718837544 2.1730734522436599 3.2154731868151809;-0.84554432309122929 0.0051012038899377133 0.10646115396439344 0.83563828725156242 0.025946560753411726 0.0044574520905128305 -0.77643386994025809 1.2331021984657153;-0.0021722937816166582 -0.0008828136862728056 -0.016213869361837763 0.2578222954632502 -0.00013207194757806827 -0.010079104549239834 -1.0520902636305833 2.1669803287031253;-0.68921549309297714 -1.3887963389264728 -0.45010384594226677 -0.66533659139447876 -0.31555344152585174 0.14481980871506328 -0.33794795748497586 0.58687781490007684;0.79800308525110197 -1.4691667252493448 -0.81414088329202761 -2.1486027889499799 -0.71212193586431627 0.12719073093580363 -0.66126811820876152 0.85834126656864607;-0.027630639127432955 -0.13671344893203011 -0.0097254455473958553 0.0095115949077705254 -5.650746355759341e-06 -1.8424684294844136 1.7346346555119134 -1.5139105199386627;0.01792344096032332 0.074660728860609052 -0.00018365408079178196 0.012317997063517688 0.00013528858910554184 -1.5759496989722801 -0.30205357554368578 1.3711281018321604;-0.0012556247871234451 0.0050166290377275536 0.014895207011737868 -0.021596004391678237 -1.4495149594512824e-05 0.74441997461283815 -0.47535372289432359 -1.356293268964436;-0.034577318389136996 0.0070701237348120482 -0.081862720014085538 -0.0083956629189884269 0.00011754117454114844 0.12577488185585553 -1.1713354719416549 -1.7309899377225944;0.21599029606742418 -0.093852461179299823 0.038088873299997446 0.030677874226428713 0.0029422070194682166 -2.4428839116102798 -0.68103401559940135 1.1870104943443698;0.021446871167993799 0.027086344862369893 -0.036544353327003981 -0.0086052376401675647 -0.0004357554861947435 -0.34808940575183284 -0.76605348006865925 -2.3014267230896754;0.1040159150540825 -0.036595348356782513 -0.0086594458303900935 -0.002589473901623539 0.000162512668069258 1.3673771587622228 -0.9748005835756629 -0.2178760422681956;0.34624630093983533 -0.036498553331561129 -0.013423178628236216 -0.0024825108104874036 -4.0823322116100962e-05 -0.0059057412825319362 -1.7207255411594369 3.4351152227011821;-0.65106793707183752 0.3674827473242922 0.33169489847889561 -0.88204701884818992 -0.90143415940644245 -0.77748549258010591 -0.90648805872446026 0.86128303270444184;-0.037770773658123112 0.36493617944435575 0.00081736274256010073 -0.004080258630258243 -0.00011402857026545676 0.0056117146401956442 1.6542232426298971 -3.3013398394082856;0.028318288153506687 -0.083399174756923947 -1.4120285577795124 -0.039252479021356382 -0.0039539475124582843 -0.17666218534165307 -1.4356591440960218 1.2327471648014925;-0.0013189307720449656 -0.01898052481326569 -0.28961831504227964 -0.035420725108863162 0.00017169319170463128 2.1777848759281939 2.6978116325734938 -0.52885391608510002;-0.000359946368984818 -0.0037186929924325788 0.014168713654926083 -0.10379477463900755 -0.00054618590319907665 -0.92392218989853425 -1.332176656956876 3.1418920539849471;0.0024550769730606777 0.0055014830858330201 -0.011165386189760027 -0.051055022316273985 0.00027752959047338052 2.1552647944720884 1.0734292375859038 2.4087804633572381;-0.82873968162123313 -1.9978735320930936 -0.08498117615013541 0.013592394345896841 1.0346823093280968 0.14576246091078013 0.083501722961793132 0.00087931543245521235;0.22453543857495034 0.96363882352634211 0.12699849188551879 -1.333222461736884 0.38858287710410233 -0.98306497662240622 0.17827941867997391 1.7813507984970494;0.0017052628356778541 -0.0017180434930413634 -0.034609782417000703 0.083624646900194596 -0.0003224215246870883 -2.4560564138995251 -0.20277585280873309 0.62010172027365118;-0.19813730129647605 0.12943644777323157 0.0084802464425825681 -0.042527544219406362 -0.0016835089603099388 -0.0083408134541477826 -0.25948563986445472 0.15511261106507301;-0.0089962829078544613 0.0041147963514113275 0.33723087752308201 0.0044607319586879605 -1.0012876833365293e-05 -0.017963629739654791 -1.6696688294783955 3.3687244666263689;0.0042493309178352626 0.018102857459596888 -0.081630063928662053 0.0076061243055866598 9.2138371869847691e-05 -1.9278903118409385 -0.93991463808564157 -2.1911412733690261;1.279433525288215 -1.4905932616709534 0.3876636497135264 -0.49537013173334893 1.035023527190196 -0.020649888232676505 -0.5742579057952848 -0.97260576923440833;0.011198394201786996 -0.016350279443760472 -0.18927809312888297 -0.015421559324073441 -0.00024943078552542609 0.17081470177402355 -0.95616983207227202 -0.52612817673015155;0.00062794462715292428 -0.0086892352431020316 0.0070304708735035694 -0.0015755142613372783 -4.0659632814151162e-05 -0.099885995859887666 1.3586672090840151 1.4466075269170535;-0.0021637167772532418 -0.0051014362845169395 0.028242733779975004 -0.087439470062624577 -0.0001294156152150586 0.59587539805945944 2.4275796574532564 2.3564833563303789;0.048338317848669127 -0.023578776396329694 0.0088984123914207531 -0.00031100863496606669 0.00037317192855125585 -3.467528037308528 -1.4800117786375 -3.2190685037670819;-0.099710870738790092 0.047424763390901674 -0.020343917715533337 -0.010184436911145007 0.00078234897261274738 -0.47906113671185607 0.97847085596990313 0.69038968453673522;-0.34318631555033763 -1.3508917391850128 1.5959296281714124 0.099176271401643132 -0.26153382281293586 0.58531678415203225 0.29066013523229745 1.073898806544525;0.73578553530094004 0.055362035477492556 0.2702276607347377 0.28989142142755214 -0.025658643924796738 -0.35725130002483435 -0.98332673445590491 0.89361332736881427];

% Layer 2
b2 = [-0.58860030920667517;-0.064751788093898921;0.19347734900941116;0.72470527343441637];
LW2_1 = [-0.00071933340462695234 0.65646608517995064 -0.13659530790942814 -0.67322990724644904 -0.006607241054864225 0.24688866517756841 0.0016187766673827148 -0.077214087494961003 -0.12848825228743482 0.084845326615843875 0.019601919080558555 -0.1248093016431515 -0.001547554439799956 -0.16957014229561329 -0.032287466209667527 -1.4982316922500574 0.25045140410463634 -2.6574703389007786 2.459012971835997 -0.0091575195151795425 -0.20753725321434052 0.21071317733948516 -0.018418251375680129 -0.01939971500024347 -0.021699137033084823 0.00019441863206373777 -0.23271904471982255 -0.30616718860454184 0.23034511097415894 -0.00024506009513746547 -0.0015699314469575538 0.23746527605730483 0.0078452119898782969 0.094672511486597 -0.0001916214622541513 0.00023265916326517625 0.21345432756778718 -0.39816266106057924 -1.4481662553565318 1.3921625699386535 -0.07497441087494025 0.59323504840671593 -0.39207317764583988 2.8309085544923924 -0.00020490170904935331 0.29016498769445104 0.017234966360814816 0.11220303025988533 -0.16333156319492445 -0.66650320606839586 -0.00036739096292189152 -0.0003078602580300012 -0.16364329878421169 0.20770242882023188 2.3999963633379644 -1.4853265884001623 -0.00043045506673576161 0.31776138453104669 -0.18221647179235645 0.11634076047096757 1.0983133054559193 -0.67550126796524634 -0.0019493849864332343 -0.015140059940559347;-0.0032332491870420248 -0.1866451053738637 0.36826800169917862 -0.65107479603748264 -0.008712602688652404 0.27111105552726278 0.00037142699303120783 -0.44626915719711913 -0.12183538930128703 0.50536782819398041 -0.0070020716091687557 -0.50323782894134128 0.00054155225077697356 -0.14826544581824749 0.014926285571330347 -0.14833399439988806 0.076032173494427091 -2.8338473959156367 0.23893119580406558 -0.001302403069103186 -0.20387558070361603 1.1167778081330295 -0.05630753121894122 0.013440877849915734 0.74956815521226694 0.00073413430477828779 -2.1575192328074886 -0.81142484973397722 -0.048577817279481184 -0.00017792300415988074 0.00055903486358340458 -0.084991081795886061 -0.0029327026722946051 -0.065053996641013939 -0.0014660184202524645 -0.00051902033831493794 0.59052061761973129 -1.0519758332225575 -3.1012011542202176 0.80029104289086173 0.033899234158847241 0.87240225372810443 0.090594774736117295 0.27616974387915949 0.00040346880289216679 2.6704426463506366 0.01456889925168349 0.12049606167390864 -0.27598202435802627 -0.86002115347466379 0.00053039323046262033 0.00062635116434733038 -0.17763270410011603 -0.024163069443149981 2.5108211542917198 -1.4243568394663975 0.0010271618984060834 0.35195227190199779 -1.6291132243735436 0.07360608573059052 -0.70857763652295935 0.12361133750528693 -0.0041287463872642458 -0.0014772829303690809;9.9444866181502024e-06 0.73993389603241366 0.59540303055810373 1.8797102053404471 -0.00053144483520441079 1.3879001536492177 0.00010558298894341034 0.63800889918569692 -0.05529921283491232 -0.28066160900323744 0.017705238503712244 -0.20554313452214662 -0.0011622769033106262 -0.017547164859893643 -0.31375791628009292 -1.379504619148096 0.12387525230128428 -0.094311507248606471 2.4726960005131899 -0.0027901774228711955 -0.15039363104976752 0.46661439627977069 -0.078737364121287984 -0.059439484828197296 1.3755278615198243 0.00038482427944389698 -0.2199428960737298 -0.30848235733830609 -2.6745193101964868 -0.00018792289128295844 -0.0023257503218748385 2.1742531432208403 0.018012698289186817 3.5407033530865033 -0.00073917376103552418 0.00091054143977462889 0.23166869720765751 -0.43285453450700079 1.2644685633527428 0.59608293684792046 -0.074978318117545587 0.35789768104840358 -0.41361909425400162 2.8708043545458608 -0.00039913071434174915 0.29362686310482511 0.0024696527206945602 0.01701720173207627 0.92274104053624106 -1.2760268075323082 -0.00028011076438180777 0.0012660619685514421 0.67258779250416389 0.15266755350209654 0.10754118585700943 -0.086156281541067845 -0.00044727911815087767 -0.00050034251124623998 1.4451255662990696 -0.50134101176661683 1.2237175688403357 -0.59960546691733418 -0.00025529174804151739 -0.01387326826836429;-0.0010853810292548336 -0.097814521150430531 1.1056460535637131 1.9302250047624092 -0.0021391554622527645 1.4187445752573173 -0.00048770878790255201 0.28139968971999679 -0.047120810449853119 0.15441803191024173 -0.009856577074388145 -0.58153357139335826 0.00073550695588281651 0.0049252623657397299 -0.2607309823289351 -0.034584558946255263 -0.047221329279853931 -0.25337998848448257 0.26735284051075064 0.00030105944314130317 -0.13810007400377686 1.3709852807636189 -0.11733783952814655 -0.024069738099010973 2.1361234709481969 0.00039348275331522277 -2.1452897506220023 -0.80784127084195767 -2.9808525230080658 -0.00030560356526760122 -0.00047839097817367821 1.8770192731026136 0.0044995623821927891 3.3804982878588627 -0.0015476786880748489 -0.00090733748934713034 0.60551568405780509 -1.0795524779409793 -0.32731191054143721 0.009097201851329265 0.034311978828051502 0.63081276547118648 0.067238199715129815 0.32179803280392821 0.00027204811124966621 2.6630586940805836 0.0012664460061690527 0.02432720402853987 0.82295217016537237 -1.474385096268797 0.00073716705090600223 0.0034042811265914165 0.67527833313798913 -0.087754249631905465 0.22452311395189781 -0.0031802127211413198 0.00022728028792530185 0.032588868843522752 0.030415731074862867 -0.5490831725018559 -0.56987225769450878 0.194552263012294 -0.0003888216466527367 -0.0003067047365499883];

% Output 1
y1_step1.ymin = -1;
y1_step1.gain = [5.6382022028456e-05;5.64408936851106e-05;5.62519863982697e-05;5.65942166370019e-05];
y1_step1.xoffset = [-17797.5;-17763.6;-17829.7;-17748.9];

% ===== SIMULATION ========

% Format Input Arguments
isCellX = iscell(X);
if ~isCellX, X = {X}; end;

% Dimensions
TS = size(X,2); % timesteps
if ~isempty(X)
  Q = size(X{1},2); % samples/series
else
  Q = 0;
end

% Allocate Outputs
Y = cell(1,TS);

% Time loop
for ts=1:TS

    % Input 1
    Xp1 = mapminmax_apply(X{1,ts},x1_step1);
    
    % Layer 1
    a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*Xp1);
    
    % Layer 2
    a2 = repmat(b2,1,Q) + LW2_1*a1;
    
    % Output 1
    Y{1,ts} = mapminmax_reverse(a2,y1_step1);
end

% Final Delay States
Xf = cell(1,0);
Af = cell(2,0);

% Format Output Arguments
if ~isCellX, Y = cell2mat(Y); end
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings)
  y = bsxfun(@minus,x,settings.xoffset);
  y = bsxfun(@times,y,settings.gain);
  y = bsxfun(@plus,y,settings.ymin);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n,~)
  a = 2 ./ (1 + exp(-2*n)) - 1;
end

% Map Minimum and Maximum Output Reverse-Processing Function
function x = mapminmax_reverse(y,settings)
  x = bsxfun(@minus,y,settings.ymin);
  x = bsxfun(@rdivide,x,settings.gain);
  x = bsxfun(@plus,x,settings.xoffset);
end
